fn predict(x: [f64; 7], w: [f64; 3], P: [f64; 49], Q: [f64; 49], dT: f64) -> ([f64; 7], [f64; 49]) {
    let d_t = dT;
    let nx = [
        ((0.5 * dT * w[0] * x[0] - 0.5 * dT * w[1] * x[3]
            + 0.5 * dT * w[2] * x[2]
            - 0.5 * dT * x[0] * x[4]
            - 0.5 * dT * x[2] * x[6]
            + 0.5 * dT * x[3] * x[5]
            + x[1])
            .powi(2)
            + (-0.5 * dT * w[0] * x[1]
                - 0.5 * dT * w[1] * x[2]
                - 0.5 * dT * w[2] * x[3]
                + 0.5 * dT * x[1] * x[4]
                + 0.5 * dT * x[2] * x[5]
                + 0.5 * dT * x[3] * x[6]
                + x[0])
                .powi(2)
            + (-0.5 * dT * w[0] * x[2]
                + 0.5 * dT * w[1] * x[1]
                + 0.5 * dT * w[2] * x[0]
                - 0.5 * dT * x[0] * x[6]
                - 0.5 * dT * x[1] * x[5]
                + 0.5 * dT * x[2] * x[4]
                + x[3])
                .powi(2)
            + (0.5 * dT * w[0] * x[3] + 0.5 * dT * w[1] * x[0]
                - 0.5 * dT * w[2] * x[1]
                - 0.5 * dT * x[0] * x[5]
                + 0.5 * dT * x[1] * x[6]
                - 0.5 * dT * x[3] * x[4]
                + x[2])
                .powi(2))
        .sqrt()
        .recip()
            * (-0.5 * dT * w[0] * x[1]
                - 0.5 * dT * w[1] * x[2]
                - 0.5 * dT * w[2] * x[3]
                + 0.5 * dT * x[1] * x[4]
                + 0.5 * dT * x[2] * x[5]
                + 0.5 * dT * x[3] * x[6]
                + x[0]),
        ((0.5 * dT * w[0] * x[0] - 0.5 * dT * w[1] * x[3]
            + 0.5 * dT * w[2] * x[2]
            - 0.5 * dT * x[0] * x[4]
            - 0.5 * dT * x[2] * x[6]
            + 0.5 * dT * x[3] * x[5]
            + x[1])
            .powi(2)
            + (-0.5 * dT * w[0] * x[1]
                - 0.5 * dT * w[1] * x[2]
                - 0.5 * dT * w[2] * x[3]
                + 0.5 * dT * x[1] * x[4]
                + 0.5 * dT * x[2] * x[5]
                + 0.5 * dT * x[3] * x[6]
                + x[0])
                .powi(2)
            + (-0.5 * dT * w[0] * x[2]
                + 0.5 * dT * w[1] * x[1]
                + 0.5 * dT * w[2] * x[0]
                - 0.5 * dT * x[0] * x[6]
                - 0.5 * dT * x[1] * x[5]
                + 0.5 * dT * x[2] * x[4]
                + x[3])
                .powi(2)
            + (0.5 * dT * w[0] * x[3] + 0.5 * dT * w[1] * x[0]
                - 0.5 * dT * w[2] * x[1]
                - 0.5 * dT * x[0] * x[5]
                + 0.5 * dT * x[1] * x[6]
                - 0.5 * dT * x[3] * x[4]
                + x[2])
                .powi(2))
        .sqrt()
        .recip()
            * (0.5 * dT * w[0] * x[0] - 0.5 * dT * w[1] * x[3]
                + 0.5 * dT * w[2] * x[2]
                - 0.5 * dT * x[0] * x[4]
                - 0.5 * dT * x[2] * x[6]
                + 0.5 * dT * x[3] * x[5]
                + x[1]),
        ((0.5 * dT * w[0] * x[0] - 0.5 * dT * w[1] * x[3]
            + 0.5 * dT * w[2] * x[2]
            - 0.5 * dT * x[0] * x[4]
            - 0.5 * dT * x[2] * x[6]
            + 0.5 * dT * x[3] * x[5]
            + x[1])
            .powi(2)
            + (-0.5 * dT * w[0] * x[1]
                - 0.5 * dT * w[1] * x[2]
                - 0.5 * dT * w[2] * x[3]
                + 0.5 * dT * x[1] * x[4]
                + 0.5 * dT * x[2] * x[5]
                + 0.5 * dT * x[3] * x[6]
                + x[0])
                .powi(2)
            + (-0.5 * dT * w[0] * x[2]
                + 0.5 * dT * w[1] * x[1]
                + 0.5 * dT * w[2] * x[0]
                - 0.5 * dT * x[0] * x[6]
                - 0.5 * dT * x[1] * x[5]
                + 0.5 * dT * x[2] * x[4]
                + x[3])
                .powi(2)
            + (0.5 * dT * w[0] * x[3] + 0.5 * dT * w[1] * x[0]
                - 0.5 * dT * w[2] * x[1]
                - 0.5 * dT * x[0] * x[5]
                + 0.5 * dT * x[1] * x[6]
                - 0.5 * dT * x[3] * x[4]
                + x[2])
                .powi(2))
        .sqrt()
        .recip()
            * (0.5 * dT * w[0] * x[3] + 0.5 * dT * w[1] * x[0]
                - 0.5 * dT * w[2] * x[1]
                - 0.5 * dT * x[0] * x[5]
                + 0.5 * dT * x[1] * x[6]
                - 0.5 * dT * x[3] * x[4]
                + x[2]),
        ((0.5 * dT * w[0] * x[0] - 0.5 * dT * w[1] * x[3]
            + 0.5 * dT * w[2] * x[2]
            - 0.5 * dT * x[0] * x[4]
            - 0.5 * dT * x[2] * x[6]
            + 0.5 * dT * x[3] * x[5]
            + x[1])
            .powi(2)
            + (-0.5 * dT * w[0] * x[1]
                - 0.5 * dT * w[1] * x[2]
                - 0.5 * dT * w[2] * x[3]
                + 0.5 * dT * x[1] * x[4]
                + 0.5 * dT * x[2] * x[5]
                + 0.5 * dT * x[3] * x[6]
                + x[0])
                .powi(2)
            + (-0.5 * dT * w[0] * x[2]
                + 0.5 * dT * w[1] * x[1]
                + 0.5 * dT * w[2] * x[0]
                - 0.5 * dT * x[0] * x[6]
                - 0.5 * dT * x[1] * x[5]
                + 0.5 * dT * x[2] * x[4]
                + x[3])
                .powi(2)
            + (0.5 * dT * w[0] * x[3] + 0.5 * dT * w[1] * x[0]
                - 0.5 * dT * w[2] * x[1]
                - 0.5 * dT * x[0] * x[5]
                + 0.5 * dT * x[1] * x[6]
                - 0.5 * dT * x[3] * x[4]
                + x[2])
                .powi(2))
        .sqrt()
        .recip()
            * (-0.5 * dT * w[0] * x[2]
                + 0.5 * dT * w[1] * x[1]
                + 0.5 * dT * w[2] * x[0]
                - 0.5 * dT * x[0] * x[6]
                - 0.5 * dT * x[1] * x[5]
                + 0.5 * dT * x[2] * x[4]
                + x[3]),
        x[4],
        x[5],
        x[6],
    ];
    println!("{:?}", nx);
    let mut np: [f64; 49] = [0.0; 49];
    np[0] = 0.5
        * d_t
        * (0.5 * d_t * P[32] * x[1]
            + 0.5 * d_t * P[39] * x[2]
            + 0.5 * d_t * P[46] * x[3]
            + P[4])
        * x[1]
        + 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[1]
                + 0.5 * d_t * P[40] * x[2]
                + 0.5 * d_t * P[47] * x[3]
                + P[5])
            * x[2]
        + 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[1]
                + 0.5 * d_t * P[41] * x[2]
                + 0.5 * d_t * P[48] * x[3]
                + P[6])
            * x[3]
        + 0.5 * d_t * P[28] * x[1]
        + 0.5 * d_t * P[35] * x[2]
        + 0.5 * d_t * P[42] * x[3]
        + P[0]
        + Q[0];
    np[1] = -0.5
        * d_t
        * (0.5 * d_t * P[32] * x[1]
            + 0.5 * d_t * P[39] * x[2]
            + 0.5 * d_t * P[46] * x[3]
            + P[4])
        * x[0]
        + 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[1]
                + 0.5 * d_t * P[40] * x[2]
                + 0.5 * d_t * P[47] * x[3]
                + P[5])
            * x[3]
        - 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[1]
                + 0.5 * d_t * P[41] * x[2]
                + 0.5 * d_t * P[48] * x[3]
                + P[6])
            * x[2]
        + 0.5 * d_t * P[29] * x[1]
        + 0.5 * d_t * P[36] * x[2]
        + 0.5 * d_t * P[43] * x[3]
        + P[1]
        + Q[1];
    np[2] = -0.5
        * d_t
        * (0.5 * d_t * P[32] * x[1]
            + 0.5 * d_t * P[39] * x[2]
            + 0.5 * d_t * P[46] * x[3]
            + P[4])
        * x[3]
        - 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[1]
                + 0.5 * d_t * P[40] * x[2]
                + 0.5 * d_t * P[47] * x[3]
                + P[5])
            * x[0]
        + 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[1]
                + 0.5 * d_t * P[41] * x[2]
                + 0.5 * d_t * P[48] * x[3]
                + P[6])
            * x[1]
        + 0.5 * d_t * P[30] * x[1]
        + 0.5 * d_t * P[37] * x[2]
        + 0.5 * d_t * P[44] * x[3]
        + P[2]
        + Q[2];
    np[3] = 0.5
        * d_t
        * (0.5 * d_t * P[32] * x[1]
            + 0.5 * d_t * P[39] * x[2]
            + 0.5 * d_t * P[46] * x[3]
            + P[4])
        * x[2]
        - 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[1]
                + 0.5 * d_t * P[40] * x[2]
                + 0.5 * d_t * P[47] * x[3]
                + P[5])
            * x[1]
        - 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[1]
                + 0.5 * d_t * P[41] * x[2]
                + 0.5 * d_t * P[48] * x[3]
                + P[6])
            * x[0]
        + 0.5 * d_t * P[31] * x[1]
        + 0.5 * d_t * P[38] * x[2]
        + 0.5 * d_t * P[45] * x[3]
        + P[3]
        + Q[3];
    np[4] = 0.5 * d_t * P[32] * x[1]
        + 0.5 * d_t * P[39] * x[2]
        + 0.5 * d_t * P[46] * x[3]
        + P[4]
        + Q[4];
    np[5] = 0.5 * d_t * P[33] * x[1]
        + 0.5 * d_t * P[40] * x[2]
        + 0.5 * d_t * P[47] * x[3]
        + P[5]
        + Q[5];
    np[6] = 0.5 * d_t * P[34] * x[1]
        + 0.5 * d_t * P[41] * x[2]
        + 0.5 * d_t * P[48] * x[3]
        + P[6]
        + Q[6];
    np[7] = 0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[0] + 0.5 * d_t * P[39] * x[3]
            - 0.5 * d_t * P[46] * x[2]
            + P[11])
        * x[1]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[0] + 0.5 * d_t * P[40] * x[3]
                - 0.5 * d_t * P[47] * x[2]
                + P[12])
            * x[2]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[0] + 0.5 * d_t * P[41] * x[3]
                - 0.5 * d_t * P[48] * x[2]
                + P[13])
            * x[3]
        - 0.5 * d_t * P[28] * x[0]
        + 0.5 * d_t * P[35] * x[3]
        - 0.5 * d_t * P[42] * x[2]
        + P[7]
        + Q[7];
    np[8] = -0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[0] + 0.5 * d_t * P[39] * x[3]
            - 0.5 * d_t * P[46] * x[2]
            + P[11])
        * x[0]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[0] + 0.5 * d_t * P[40] * x[3]
                - 0.5 * d_t * P[47] * x[2]
                + P[12])
            * x[3]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[0] + 0.5 * d_t * P[41] * x[3]
                - 0.5 * d_t * P[48] * x[2]
                + P[13])
            * x[2]
        - 0.5 * d_t * P[29] * x[0]
        + 0.5 * d_t * P[36] * x[3]
        - 0.5 * d_t * P[43] * x[2]
        + P[8]
        + Q[8];
    np[9] = -0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[0] + 0.5 * d_t * P[39] * x[3]
            - 0.5 * d_t * P[46] * x[2]
            + P[11])
        * x[3]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[0] + 0.5 * d_t * P[40] * x[3]
                - 0.5 * d_t * P[47] * x[2]
                + P[12])
            * x[0]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[0] + 0.5 * d_t * P[41] * x[3]
                - 0.5 * d_t * P[48] * x[2]
                + P[13])
            * x[1]
        - 0.5 * d_t * P[30] * x[0]
        + 0.5 * d_t * P[37] * x[3]
        - 0.5 * d_t * P[44] * x[2]
        + P[9]
        + Q[9];
    np[10] = 0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[0] + 0.5 * d_t * P[39] * x[3]
            - 0.5 * d_t * P[46] * x[2]
            + P[11])
        * x[2]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[0] + 0.5 * d_t * P[40] * x[3]
                - 0.5 * d_t * P[47] * x[2]
                + P[12])
            * x[1]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[0] + 0.5 * d_t * P[41] * x[3]
                - 0.5 * d_t * P[48] * x[2]
                + P[13])
            * x[0]
        - 0.5 * d_t * P[31] * x[0]
        + 0.5 * d_t * P[38] * x[3]
        - 0.5 * d_t * P[45] * x[2]
        + P[10]
        + Q[10];
    np[11] = -0.5 * d_t * P[32] * x[0] + 0.5 * d_t * P[39] * x[3]
        - 0.5 * d_t * P[46] * x[2]
        + P[11]
        + Q[11];
    np[12] = -0.5 * d_t * P[33] * x[0] + 0.5 * d_t * P[40] * x[3]
        - 0.5 * d_t * P[47] * x[2]
        + P[12]
        + Q[12];
    np[13] = -0.5 * d_t * P[34] * x[0] + 0.5 * d_t * P[41] * x[3]
        - 0.5 * d_t * P[48] * x[2]
        + P[13]
        + Q[13];
    np[14] = 0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[3] - 0.5 * d_t * P[39] * x[0]
            + 0.5 * d_t * P[46] * x[1]
            + P[18])
        * x[1]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[3] - 0.5 * d_t * P[40] * x[0]
                + 0.5 * d_t * P[47] * x[1]
                + P[19])
            * x[2]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[3] - 0.5 * d_t * P[41] * x[0]
                + 0.5 * d_t * P[48] * x[1]
                + P[20])
            * x[3]
        - 0.5 * d_t * P[28] * x[3]
        - 0.5 * d_t * P[35] * x[0]
        + 0.5 * d_t * P[42] * x[1]
        + P[14]
        + Q[14];
    np[15] = -0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[3] - 0.5 * d_t * P[39] * x[0]
            + 0.5 * d_t * P[46] * x[1]
            + P[18])
        * x[0]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[3] - 0.5 * d_t * P[40] * x[0]
                + 0.5 * d_t * P[47] * x[1]
                + P[19])
            * x[3]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[3] - 0.5 * d_t * P[41] * x[0]
                + 0.5 * d_t * P[48] * x[1]
                + P[20])
            * x[2]
        - 0.5 * d_t * P[29] * x[3]
        - 0.5 * d_t * P[36] * x[0]
        + 0.5 * d_t * P[43] * x[1]
        + P[15]
        + Q[15];
    np[16] = -0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[3] - 0.5 * d_t * P[39] * x[0]
            + 0.5 * d_t * P[46] * x[1]
            + P[18])
        * x[3]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[3] - 0.5 * d_t * P[40] * x[0]
                + 0.5 * d_t * P[47] * x[1]
                + P[19])
            * x[0]
        + 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[3] - 0.5 * d_t * P[41] * x[0]
                + 0.5 * d_t * P[48] * x[1]
                + P[20])
            * x[1]
        - 0.5 * d_t * P[30] * x[3]
        - 0.5 * d_t * P[37] * x[0]
        + 0.5 * d_t * P[44] * x[1]
        + P[16]
        + Q[16];
    np[17] = 0.5
        * d_t
        * (-0.5 * d_t * P[32] * x[3] - 0.5 * d_t * P[39] * x[0]
            + 0.5 * d_t * P[46] * x[1]
            + P[18])
        * x[2]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[33] * x[3] - 0.5 * d_t * P[40] * x[0]
                + 0.5 * d_t * P[47] * x[1]
                + P[19])
            * x[1]
        - 0.5
            * d_t
            * (-0.5 * d_t * P[34] * x[3] - 0.5 * d_t * P[41] * x[0]
                + 0.5 * d_t * P[48] * x[1]
                + P[20])
            * x[0]
        - 0.5 * d_t * P[31] * x[3]
        - 0.5 * d_t * P[38] * x[0]
        + 0.5 * d_t * P[45] * x[1]
        + P[17]
        + Q[17];
    np[18] = -0.5 * d_t * P[32] * x[3] - 0.5 * d_t * P[39] * x[0]
        + 0.5 * d_t * P[46] * x[1]
        + P[18]
        + Q[18];
    np[19] = -0.5 * d_t * P[33] * x[3] - 0.5 * d_t * P[40] * x[0]
        + 0.5 * d_t * P[47] * x[1]
        + P[19]
        + Q[19];
    np[20] = -0.5 * d_t * P[34] * x[3] - 0.5 * d_t * P[41] * x[0]
        + 0.5 * d_t * P[48] * x[1]
        + P[20]
        + Q[20];
    np[21] = 0.5
        * d_t
        * (0.5 * d_t * P[32] * x[2]
            - 0.5 * d_t * P[39] * x[1]
            - 0.5 * d_t * P[46] * x[0]
            + P[25])
        * x[1]
        + 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[2]
                - 0.5 * d_t * P[40] * x[1]
                - 0.5 * d_t * P[47] * x[0]
                + P[26])
            * x[2]
        + 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[2]
                - 0.5 * d_t * P[41] * x[1]
                - 0.5 * d_t * P[48] * x[0]
                + P[27])
            * x[3]
        + 0.5 * d_t * P[28] * x[2]
        - 0.5 * d_t * P[35] * x[1]
        - 0.5 * d_t * P[42] * x[0]
        + P[21]
        + Q[21];
    np[22] = -0.5
        * d_t
        * (0.5 * d_t * P[32] * x[2]
            - 0.5 * d_t * P[39] * x[1]
            - 0.5 * d_t * P[46] * x[0]
            + P[25])
        * x[0]
        + 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[2]
                - 0.5 * d_t * P[40] * x[1]
                - 0.5 * d_t * P[47] * x[0]
                + P[26])
            * x[3]
        - 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[2]
                - 0.5 * d_t * P[41] * x[1]
                - 0.5 * d_t * P[48] * x[0]
                + P[27])
            * x[2]
        + 0.5 * d_t * P[29] * x[2]
        - 0.5 * d_t * P[36] * x[1]
        - 0.5 * d_t * P[43] * x[0]
        + P[22]
        + Q[22];
    np[23] = -0.5
        * d_t
        * (0.5 * d_t * P[32] * x[2]
            - 0.5 * d_t * P[39] * x[1]
            - 0.5 * d_t * P[46] * x[0]
            + P[25])
        * x[3]
        - 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[2]
                - 0.5 * d_t * P[40] * x[1]
                - 0.5 * d_t * P[47] * x[0]
                + P[26])
            * x[0]
        + 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[2]
                - 0.5 * d_t * P[41] * x[1]
                - 0.5 * d_t * P[48] * x[0]
                + P[27])
            * x[1]
        + 0.5 * d_t * P[30] * x[2]
        - 0.5 * d_t * P[37] * x[1]
        - 0.5 * d_t * P[44] * x[0]
        + P[23]
        + Q[23];
    np[24] = 0.5
        * d_t
        * (0.5 * d_t * P[32] * x[2]
            - 0.5 * d_t * P[39] * x[1]
            - 0.5 * d_t * P[46] * x[0]
            + P[25])
        * x[2]
        - 0.5
            * d_t
            * (0.5 * d_t * P[33] * x[2]
                - 0.5 * d_t * P[40] * x[1]
                - 0.5 * d_t * P[47] * x[0]
                + P[26])
            * x[1]
        - 0.5
            * d_t
            * (0.5 * d_t * P[34] * x[2]
                - 0.5 * d_t * P[41] * x[1]
                - 0.5 * d_t * P[48] * x[0]
                + P[27])
            * x[0]
        + 0.5 * d_t * P[31] * x[2]
        - 0.5 * d_t * P[38] * x[1]
        - 0.5 * d_t * P[45] * x[0]
        + P[24]
        + Q[24];
    np[25] = 0.5 * d_t * P[32] * x[2]
        - 0.5 * d_t * P[39] * x[1]
        - 0.5 * d_t * P[46] * x[0]
        + P[25]
        + Q[25];
    np[26] = 0.5 * d_t * P[33] * x[2]
        - 0.5 * d_t * P[40] * x[1]
        - 0.5 * d_t * P[47] * x[0]
        + P[26]
        + Q[26];
    np[27] = 0.5 * d_t * P[34] * x[2]
        - 0.5 * d_t * P[41] * x[1]
        - 0.5 * d_t * P[48] * x[0]
        + P[27]
        + Q[27];
    np[28] = 0.5 * d_t * P[32] * x[1]
        + 0.5 * d_t * P[33] * x[2]
        + 0.5 * d_t * P[34] * x[3]
        + P[28]
        + Q[28];
    np[29] = -0.5 * d_t * P[32] * x[0] + 0.5 * d_t * P[33] * x[3]
        - 0.5 * d_t * P[34] * x[2]
        + P[29]
        + Q[29];
    np[30] = -0.5 * d_t * P[32] * x[3] - 0.5 * d_t * P[33] * x[0]
        + 0.5 * d_t * P[34] * x[1]
        + P[30]
        + Q[30];
    np[31] = 0.5 * d_t * P[32] * x[2]
        - 0.5 * d_t * P[33] * x[1]
        - 0.5 * d_t * P[34] * x[0]
        + P[31]
        + Q[31];
    np[32] = P[32] + Q[32];
    np[33] = P[33] + Q[33];
    np[34] = P[34] + Q[34];
    np[35] = 0.5 * d_t * P[39] * x[1]
        + 0.5 * d_t * P[40] * x[2]
        + 0.5 * d_t * P[41] * x[3]
        + P[35]
        + Q[35];
    np[36] = -0.5 * d_t * P[39] * x[0] + 0.5 * d_t * P[40] * x[3]
        - 0.5 * d_t * P[41] * x[2]
        + P[36]
        + Q[36];
    np[37] = -0.5 * d_t * P[39] * x[3] - 0.5 * d_t * P[40] * x[0]
        + 0.5 * d_t * P[41] * x[1]
        + P[37]
        + Q[37];
    np[38] = 0.5 * d_t * P[39] * x[2]
        - 0.5 * d_t * P[40] * x[1]
        - 0.5 * d_t * P[41] * x[0]
        + P[38]
        + Q[38];
    np[39] = P[39] + Q[39];
    np[40] = P[40] + Q[40];
    np[41] = P[41] + Q[41];
    np[42] = 0.5 * d_t * P[46] * x[1]
        + 0.5 * d_t * P[47] * x[2]
        + 0.5 * d_t * P[48] * x[3]
        + P[42]
        + Q[42];
    np[43] = -0.5 * d_t * P[46] * x[0] + 0.5 * d_t * P[47] * x[3]
        - 0.5 * d_t * P[48] * x[2]
        + P[43]
        + Q[43];
    np[44] = -0.5 * d_t * P[46] * x[3] - 0.5 * d_t * P[47] * x[0]
        + 0.5 * d_t * P[48] * x[1]
        + P[44]
        + Q[44];
    np[45] = 0.5 * d_t * P[46] * x[2]
        - 0.5 * d_t * P[47] * x[1]
        - 0.5 * d_t * P[48] * x[0]
        + P[45]
        + Q[45];
    np[46] = P[46] + Q[46];
    np[47] = P[47] + Q[47];
    np[48] = P[48] + Q[48];
    (nx, np)
}
